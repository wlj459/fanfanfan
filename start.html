<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>番番番</title>
    <script src="pixi.js"></script>
</head>

<body>
    <script>
        var window_width = document.documentElement.scrollWidth;
        var window_height = document.documentElement.scrollHeight;
        var game_height = window_height;
        var game_width = Math.floor(window_height/1.778);
        if (game_width > window_width) {
            game_width = window_width;
            ganke_height = game_width * 1.778;
        }
        var stage = new PIXI.Container();


        var renderer = PIXI.autoDetectRenderer(game_width, game_height);
        document.body.appendChild(renderer.view);

        var sprite_back = PIXI.Sprite.fromImage("img/background@2x.png")
        game_ratio = game_width/375;

        sprite_back.scale.x = sprite_back.scale.y = game_ratio;
        stage.addChild(sprite_back);


        var sprite_grey = PIXI.Sprite.fromImage("img/background-拷贝-2@2x.png");
        sprite_grey.scale.x = sprite_grey.scale.y = game_ratio;

//=======================================================================
        var rank = 1;
        var ready = true;
        var ready_num = 3;
        var start = false;
        var start_num = 15;//00:00
        var stop = false;

        easy_p = new Array();


        for (i=1; i<=3; i++)
        {
            easy_p[i] = new Array();
           for (j=1; j<=3; j++){
               easy_p[i][j] = new Array();
               if (j == 1) {
                   if (i * j == 1) {
                       easy_p[i][j][1] = game_width * 0.013;
                       easy_p[i][j][2] = game_height * 0.257 ;
                   }
                   else {
                       easy_p[i][j][1] = easy_p[i-1][j][1];
                       easy_p[i][j][2] = easy_p[i-1][j][2] + game_height * 0.1889;
                   }
               }
               else{
                   easy_p[i][j][1] = easy_p[i][j-1][1] + game_width * 0.3413;
                   easy_p[i][j][2] = easy_p[i][j-1][2];
               }
           }
        }

        easy_card_list = new Array();
        easy_card = new Array();
        easy_card_list = ['1', '2', '3', '4', '1', '2', '3', '4', '0'];
        chosenTiles = new Array()

        for (i=1; i<=3;i++) {
            chosenTiles[i] = new Array();
            easy_card[i] = new Array();
            for (j=1; j<=3;j++) {
                var candidate=Math.floor(Math.random()*9);
                if(chosenTiles.indexOf(candidate)==-1){
                    chosenTiles[i][j] = chosenTiles;
                    //easy_card[i][j] = new PIXI.Sprite.fromImage("img/xxx" + easy_card_list[candidate] + '.png')
                    easy_card[i][j] = new PIXI.Sprite.fromImage("img/第@2x.png");
                    easy_card[i][j].position.x = easy_p[i][j][1];
                    easy_card[i][j].position.y = easy_p[i][j][2];
                    easy_card[i][j].scale.x = easy_card[i][j].scale.y = game_ratio;
                }
            }
        }

        var texture_easy = PIXI.Texture.fromImage("img/card_back_230@2x.png");

        var easy_back = new Array();
        for (i=1; i<=3; i++){
            easy_back[i] = new Array;
            for (j=1; j<=3; j++){
                easy_back[i][j] = new PIXI.Sprite(texture_easy);
                easy_back[i][j].position.x = easy_p[i][j][1];
                easy_back[i][j].position.y = easy_p[i][j][2];
                easy_back[i][j].scale.x = easy_back[i][j].scale.y = game_ratio;
            }
        }

        var sprite_di =  PIXI.Sprite.fromImage("img/第@2x.png");
        sprite_di.scale.x = sprite_di.scale.y = game_ratio;
        sprite_di.position.x = game_width * 0.3693;
        sprite_di.position.y = game_height * 0.1154;


        var style = {
            font : '80px Arial',
            fill : '#4e7e59'
        };

        // 10开始的适配还没做
        var sprite_rank_easy = new PIXI.Text(rank, style);
        sprite_rank_easy.scale.x = sprite_rank_easy.scale.y = game_ratio/2;
        sprite_rank_easy.position.x = game_width * 0.48;
        sprite_rank_easy.position.y = game_height * 0.1054;



        var sprite_guan =  PIXI.Sprite.fromImage("img/關@2x.png");
        sprite_guan.scale.x = sprite_guan.scale.y = game_ratio;
        sprite_guan.position.x = game_width * 0.5547;
        sprite_guan.position.y = game_height * 0.1154;


        var sprite_stop =  PIXI.Sprite.fromImage("img/button_stop@2x.png");
        sprite_stop.scale.x = sprite_stop.scale.y = game_ratio;
        //此处暂时没加按钮
        sprite_stop.position.x = game_width * 0.8627;
        sprite_stop.position.y = game_height * 0.9288;
        stage.addChild(sprite_stop);

        var h = null;
        if (start_num > 9) {
            h = "00:" + String(start_num);
        }
        else {
            h = "00:0" + String(start_num);
        }


        var time_style = {
            font : '40px Arial',
            fill : '#4e7e59'
        };
        var sprite_start_num = new PIXI.Text(h, time_style);
        sprite_start_num.scale.x = sprite_start_num.scale.y = game_ratio/2;
        sprite_start_num.position.x = game_width * 0.848;
        sprite_start_num.position.y = game_height * 0.1874;
        stage.addChild(sprite_start_num);

        animate();


        function animate() {

            requestAnimationFrame(animate);
            if(ready){
                if (rank<10) {
                    for (i=1;i<=3;i++){
                        for (j=1;j<=3;j++){
                            stage.addChild(easy_card[i][j]);
                        }
                    }
                    stage.addChild(sprite_di);
                    stage.addChild(sprite_rank_easy);
                    stage.addChild(sprite_guan);

                }
                stage.addChild(sprite_grey);
            }
            renderer.render(stage);
        }

    </script>
</body>
</html>